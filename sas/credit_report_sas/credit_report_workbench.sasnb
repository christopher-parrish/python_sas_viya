[{"kind":2,"language":"sas","value":"%let charlist = customer_event_char gender_char currently_employed_char homeowner_char dpd_30_currently_char responded_to_campaign_12_mo_char dpd_60_over_past_12_mos_char bankruptcy_indicator_char\r\n                unpaid_support_indicator_char collection_agency_indicator_char marital_status_char last_campaign_account_type_char id_important_activity_char id_direct_contact_char \r\n                id_current_relationship_char campaign_peer_id_char;\r\n\r\ndata credit_report;\r\n    infile \"demo/credit_report.csv\" dsd dlm=',' firstobs=2;\r\n    length &charlist. $30;\r\n    input account_id performance_period_stress customer_event gender currently_employed homeowner dpd_30_currently responded_to_campaign_12_mos dpd_60_over_past_12_mos \r\n            bankruptcy_indicator unpaid_support_indicator collection_agency_indicator marital_status last_campaign_account_type\tnum_soft_inquiries_3_mos num_hard_inquiries_3_mos\r\n            num_addresses_reported num_credit_accounts_open num_credit_accounts_closed age debt_to_income credit_utilization_ratio length_of_last_job_mos credit_history_mos \r\n            credit_score scheduled_payments_per_month id_important_activity id_direct_contact id_current_relationship campaign_peer_id geographical_code ssn \r\n            customer_event_char $ gender_char $ currently_employed_char $ homeowner_char $ dpd_30_currently_char $ responded_to_campaign_12_mo_char $ dpd_60_over_past_12_mos_char $ bankruptcy_indicator_char $\r\n            unpaid_support_indicator_char $ collection_agency_indicator_char $ marital_status_char $ last_campaign_account_type_char $ id_important_activity_char $ id_direct_contact_char $\r\n            id_current_relationship_char $ campaign_peer_id_char $;\r\nrun;","outputs":[]},{"kind":2,"language":"sas","value":"title 'Heat Map of Response to Campaigns by Peer ID and Account Type';\r\ntitle2 'Higher Frequencies Indicate Customers Responded in Higher Numbers to Targeted Campaigns by Peer (Bank) Group';\r\nproc sgplot data=credit_report;\r\n    heatmap x=campaign_peer_id_char y= last_campaign_account_type_char;\r\nrun;\r\ntitle '';","outputs":[]},{"kind":2,"language":"sas","value":"title \"Campaign Performance\";\r\nproc sgpanel data=credit_report;\r\n    panelby responded_to_campaign_12_mo_char customer_event_char / novarname ;\r\n    hbar campaign_peer_id_char;\r\nrun;\r\ntitle '';","outputs":[]},{"kind":2,"language":"sas","value":"%let input_columns =\r\n\t\t\t(account_id performance_period_stress customer_event gender currently_employed homeowner dpd_30_currently responded_to_campaign_12_mos dpd_60_over_past_12_mos \r\n            bankruptcy_indicator unpaid_support_indicator collection_agency_indicator marital_status last_campaign_account_type\tnum_soft_inquiries_3_mos num_hard_inquiries_3_mos\r\n            num_addresses_reported num_credit_accounts_open num_credit_accounts_closed age debt_to_income credit_utilization_ratio length_of_last_job_mos credit_history_mos \r\n            credit_score scheduled_payments_per_month id_important_activity id_direct_contact id_current_relationship campaign_peer_id geographical_code ssn customer_event_char\r\n            gender_char currently_employed_char homeowner_char dpd_30_currently_char responded_to_campaign_12_mo_char dpd_60_over_past_12_mos_char bankruptcy_indicator_char\r\n            unpaid_support_indicator_char collection_agency_indicator_char marital_status_char last_campaign_account_type_char id_important_activity_char id_direct_contact_char\r\n            id_current_relationship_char campaign_peer_id_char);\r\n\r\nproc binning data=credit_report numbin=8 woe;\r\n   input num_credit_accounts_open\r\n         age\r\n         debt_to_income\r\n         credit_utilization_ratio\r\n         length_of_last_job_mos\r\n         credit_history_mos\r\n         credit_score\r\n         scheduled_payments_per_month;\r\n   target customer_event/event='1';\r\n   output out=credit_report_woe copyvars=&input_columns;\r\nrun;","outputs":[]},{"kind":2,"language":"sas","value":"data credit_report_woe;\r\n    set credit_report_woe;\r\n    rename BIN_num_credit_accounts_open=woe_num_credit_accounts_open\r\n            BIN_age=woe_age\r\n            BIN_debt_to_income=woe_debt_to_income\r\n            BIN_credit_utilization_ratio=woe_credit_utilization_ratio\r\n            BIN_length_of_last_job_mos=woe_length_of_last_job_mos\r\n            BIN_credit_history_mos=woe_credit_history_mos\r\n            BIN_credit_score=woe_credit_score\r\n            BIN_scheduled_payments_per_month=woe_scheduled_payments_per_month;\r\nrun;","outputs":[]},{"kind":2,"language":"sas","value":"proc logselect data=credit_report_woe;\r\n    model customer_event (event = '0') = \r\n            woe_num_credit_accounts_open\r\n            woe_age\r\n            woe_debt_to_income\r\n            woe_credit_utilization_ratio\r\n            woe_length_of_last_job_mos\r\n            woe_credit_history_mos\r\n            woe_credit_score\r\n            woe_scheduled_payments_per_month;\r\n    selection method=NONE;\r\n    output out=logselect_out allstat copyvars=account_id;\r\nrun;","outputs":[]},{"kind":2,"language":"sas","value":"%let target_score = 600;\r\n%let target_odds = 30;\r\n%let points_to_double_the_odds = 20;\r\n%let factor = &points_to_double_the_odds / log(2);\r\n%let offset = &target_score - &factor * log(&target_odds);\r\n\r\ndata credit_report_score;\r\n    set logselect_out;\r\n    log_odds = _XBETA_;\r\n    prob_good_credit = _PRED_;\r\n    score = &offset + (&factor * log_odds);\r\nrun;","outputs":[]},{"kind":2,"language":"sas","value":"proc sgplot data=credit_report_score;\r\n    histogram score;\r\n    title 'Distribution of Scores';\r\nrun;\r\ntitle '';","outputs":[]},{"kind":2,"language":"sas","value":"proc print data=credit_report_score (obs=25);\r\n    var account_id log_odds prob_good_credit score;\r\nrun;","outputs":[]},{"kind":2,"language":"sas","value":"/* export table to csv */\r\nproc export data=credit_report_woe\r\n  outfile=\"demo/credit_report_woe.csv\"\r\n  dbms=csv\r\n  replace;\r\nrun;","outputs":[]}]